(function(n){registerNamespace("$UI"),window.$UI.Dialog=function(t,i,r,u,f,e){function d(){if(v){var t=v.style,n=$B.IE&&$B.V==7?nt.offsetLeft/100:1;n==0&&(n=1),$B.IE&&$B.V==6&&(t.width=it.scrollWidth-3+"px",t.pixelTop=Math.max(0,it.scrollTop/n)),t.pixelHeight=p.clientHeight/n,t.pixelWidth=p.clientWidth/n}}function ft(n){var t;t=n.target==b?$UI.Dialog.findFocusableElement(o,k,!1):$UI.Dialog.findFocusableElement(o,b,!0),t&&setTimeout(function(){try{t.focus()}catch(n){}},0)}function ot(){n(window).bind({"resize.ext":rt,"scroll.ext":rt})}function rt(){n(window).unbind(".ext",rt),h.recalc(!1),ot()}function st(){var i,n,r,t;if($B.IE&&$B.V<7)for(s=a.getElementsByTagName("select"),i=o.getElementsByTagName("select"),n=0;n<s.length;n++){for(r=!1,t=0;t<i.length;t++)if(s[n]==i[t]){r=!0;break}r||(s[n].wlppHide=s[n].style.visibility,s[n].style.visibility="hidden")}}var ut=window;f&&(ut=f);var a=ut.document||ut.ownerDocument,g=a.body,p=a.documentElement,it=$B.RE_WebKit?g:a.documentElement,et=g.className.indexOf("rtl")>-1,v,nt,h=this,c=n(),y=n(),o=null,w=null,b,k,ct,s,ht,tt=null,l=null;this.dock=new $UI.Dialog.Rect(0,0,0,0),i&&i<5&&(i=5),u=u?" "+u:"",this.dispose=function(){ht=!0,tt&&(n(window).unbind("resize",tt),tt=null),l&&(n(window).unbind("focus",l),l=null),c.remove(),c=n(),y.remove(),y=n(),s=null,v=null,nt=null,b=null,k=null,n(window).unbind(".ext",rt)},this.setContents=function(i){var l,f,r,s,h,v;return c.remove(),c=n(),o=i,l=o.parentNode,(null==l||null==l.tagName)&&(g.appendChild(o),c=c.add(n(o))),f={"aria-hidden":"true"},r=null,$B.RE_WebKit?r="input":(r="a",f.href="#"),b=a.createElement(r),k=a.createElement(r),s=n(b).attr(f).css("position","absolute"),h=n(k).attr(f).css("position","absolute"),(e===undefined||e)&&(s.bind("focus",ft),h.bind("focus",ft)),c=c.add(s),c=c.add(h),n(o).prepend(s).append(h),$B.RE_WebKit&&(v="-10000px",et?k.style.right=b.style.right=v:k.style.left=b.style.left=v),o.style.position="absolute",o.className+=u,!t&&$B.IE&&$B.V<7&&(w=new $UI.FramePopup),ot(),o},this.recalc=function(t){var e,u,l,s,c,f;o&&(d(),e=n(o),r||(u=$UI.Dialog.getLocation(o),(!u||u.isEmpty())&&(l={visibility:e.css("visibility")||"visible",display:e.css("display")||"auto"},e.css({visibility:"hidden",display:"block"}),u=$UI.Dialog.getLocation(o),e.css(l)),h.dock||(h.dock=new $UI.Dialog.Rect(0,0,0,0)),s=p.clientWidth/2-u.width/2,et?(h.dock.x=Math.min(s,-25-(u.width-p.clientWidth)),$B.RE_WebKit&&(h.dock.x+=it.scrollWidth-p.clientWidth)):h.dock.x=Math.max(s,25),t&&(c=p.clientHeight-u.height-3,h.dock.y=it.scrollTop+Math.min(Math.max(c>200?c:(p.clientHeight-u.height)/2,0),100)),h.dock.height=u.height,h.dock.width=u.width),f=null,h.dock.y!==null&&(f={top:h.dock.y}),h.dock.x!==null&&(f=f||{},f.left=h.dock.x),f&&e.css(f),w&&w.positionAt(h.dock,i?1e3:i-2))},this.show=function(r,f,s){function b(){try{(r?r:$UI.Dialog.findFocusableElement(o)).focus()}catch(n){}}var p,w,c;h.recalc(!0),p=n(o),p.show(),i&&p.css("z-index",i),t&&(v=a.createElement("div"),st(),nt=a.createElement("div"),w=n(nt).addClass("UI_Dialog_ZoomTest"+u),l=function(n){return n.stopImmediatePropagation(),!1},c=n(v).attr("id","UI_Dialog_BG").addClass("UI_Dialog_BG"+u).bind({click:l,mousedown:l,keydown:l,keypress:l,dblclick:l}),(e===undefined||e)&&c.bind("focus",ft),i&&c.css("z-index",i-1),g.appendChild(v),g.appendChild(nt),tt=function(){setTimeout(d,0)},n(window).bind({resize:tt,focus:l}),y=y.add(c),y=y.add(w),d()),f||(s=s||n.when(),s.then(function(){setTimeout(b,10)}))},this.hide=function(){if(y.remove(),y=n(),$B.IE&&$B.V<7&&s){for(var t=0;t<s.length;t++)typeof s[t].wlppHide!="undefined"&&(s[t].style.visibility=s[t].wlppHide);s=null}},this.minimize=function(){if(w&&w.minimize(),o.style.visibility="hidden",t){if(v.style.display="none",s)for(var n=0;n<s.length;n++)s[n].style.visibility=s[n].wlppHide;d()}d()},this.restore=function(){o.style.visibility="visible",w&&w.restore(),h.recalc(!0),t&&(v.style.display="block",st(),d())}},window.$UI.Dialog.Rect=function(n,t,i,r){return new function(){var u=this;this.x=n,this.y=t,this.width=i,this.height=r,this.isEmpty=function(){return u.width<=0||u.height<=0}}},window.$UI.Dialog.findFocusableElement=function(t,i,r){function o(t){var i=n(t),u=i.attr("tabindex"),r;return u==="-1"?!1:i.is(".CloseX")&&i.is(":visible")&&i.parents(":hidden").length===0?!0:(r="|BUTTON|TEXTAREA|FIELDSET|IFRAME|SELECT|",t.tagName&&!t.disabled&&(r.indexOf("|"+t.tagName+"|")>-1||t.tagName=="A"&&t.href&&t.className.indexOf("CloseX")==-1||t.tagName=="INPUT"&&t.type.toLowerCase()!="hidden"&&(!$B.Firefox||t.type.toLowerCase()!="file"))&&n(t).is(":visible"))}function u(n){if(!n)return null;for(var t=r?n.nextSibling:n.previousSibling;t&&t.nodeType!=1;)t=r?t.nextSibling:t.previousSibling;return t?t:u(n.parentNode)}function f(t,i){var f=i;if(f&&(f==t||n.contains(t,f)))while(f!=null){if(o(f))return f;f=r&&f.firstChild?f.firstChild:!r&&f.lastChild?f.lastChild:u(f)}return null}i=i?u(i):t;var e=f(t,i);return!e&&i&&i!=t?f(t,t):e},window.$UI.Dialog.getLocation=function(n){if(!n)return new $UI.Dialog.Rect(0,0,0,0);for(var i=0,r=0,t=n;t;)i+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;return new $UI.Dialog.Rect(i,r,n.offsetWidth,n.offsetHeight)},window.$UI.Popover=function(){function nt(){try{d.focus()}catch(n){}}function g(){var i=t.modal?$B.IE?n("body"):n(window):n(u);$B.IE?i.bind("keypress.showhide",a):i.bind("keydown.showhide",a),p=p.add(i)}function tt(){var i=t.modal?$B.IE?n("body"):n(window):n(u);i.unbind(".showhide",a)}function it(t,i,r,u){var e,f;n("<span />").text(" ").appendTo(n(v)),e=_ce("div"),n(e).html('<button id="popover_btn_{0}" type="{1}" />'.format(t,r?"submit":"button")),f=n(e.firstChild).toggleClass("Default",r).html("<nobr>"+i+"<\/nobr>").bind("click",function(n){w(t),n.stopPropagation()}),y=y.add(n(f)),!r&&u&&(o=t),s[t]=f,n(f).appendTo(n(v))}function a(n){switch(n.which){case 27:w(o?o:"$cancel"),n.stopPropagation()}}function w(n){var i=!0;k&&(i=k(t,n)),i&&t.hide()}function rt(){function i(t,i){if(t){var r=n(i);typeof t=="string"?r.html(t):r.html("").append(t)}}if(n(h).toggle(t.showHeader),n(l).toggle(t.showFooter),n(e).toggle(t.showCloseX).bind("click",function(){return w(o?o:"$cancel"),!1}),t.showCloseX){var r=GetString("live.shared.skydrive.pc.Sharing.Close");n(e).append(wLive.Core.ImageStrip.getImage("close",r,r))}t.bodyPadding||n(c).css("padding","0px"),i(t.header,b),i(t.body,c)}this.header=null,this.body=null,this.footerText=null,this.width=300,this.bodyPadding=!0,this.showHeader=!0,this.showFooter=!0,this.modal=!1,this.showCloseX=!1,this.zIndex=null,this.dispose=function(){i&&(i.dispose(),i=null)},this.addButton=function(n,t,i,r){f.push({name:n,value:t,isDefault:i,isCancel:r})},this.show=function(a,y,p,w){var ft,tt,ut,nt;if(!r){if(k=a,d=y,!i){for(i=new $UI.Dialog(t.modal,t.zIndex),u=_ce("div"),ft=n(u).hide().html('<a href="#"><\/a><div><h3><\/h3><\/div><div><\/div><div><nobr><\/nobr><\/div>'),i.setContents(u),g(),ft.addClass("UI_Popover"),tt=u.childNodes,e=tt[1],h=tt[2],c=tt[3],l=tt[4],b=h.firstChild,v=l.firstChild,n(e).addClass("CloseX"),n(h).addClass("Header"),n(c).addClass("Body"),n(l).addClass("Footer"),t.width!=null&&(ut=t.width,ft.css("width",parseInt(ut,10)==ut?ut+"px":ut)),o=null,s=[],nt=0;nt<f.length;nt++)it(f[nt].name,f[nt].value,f[nt].isDefault,f[nt].isCancel);f.length==0&&(t.showFooter=!1),rt()}i.show(p?s[p]:null,w),r=!0}},this.hide=function(){if(r){d&&setTimeout(nt,10);try{n(e).unbind("click"),p.unbind(".showhide",a),p=n(),y.remove(),y=n(),i.hide(),this.dispose()}catch(t){}r=!1,u=e=h=l=c=b=v=s=null}},this.enableButton=function(t){n(s[t]).attr("disabled",!1)},this.disableButton=function(t){n(s[t]).attr("disabled",!0)},this.recalc=function(){r&&i&&i.recalc(!1)},this.minimize=function(){i&&r&&(i.minimize(),tt())},this.restore=function(){i&&r&&(i.restore(),g())};var r=!1,i,t=this,h,c,l,e,b,v,o,s,y=n(),p=n(),u,f=[],k=null,d=null}})(window.originaljQuery||jQuery),$UI.MsgBoxEx=function(n,t,i,r,u,f,e,o,s){var a="ok",v="cancel",h=new $UI.Popover,p=_ce("div"),w=function(n,t){var i=!0;return t==a?u({Popover:n})==!1&&(i=!1):t!=v||!f||f(),i&&(h=null),i},c,y,l;if(e)for(c=temp=e,y=0;y<10&&temp;y++){if(l=temp.tagName&&temp.tagName.toLowerCase(),l=="a"||l=="button"||l=="input"){c=temp;break}if(temp=temp.parentElement,!temp){c=null;break}}return t&&(p.innerHTML='<div style="margin-bottom:10px">'+t+"<\/div>"),h.width=o?o:"416px",h.header=n,h.body=p,h.modal=!0,i!=!1&&h.addButton(a,i,!0,!1),r!=!1&&h.addButton(v,r,!1,!0),h.show(w,c,s?v:a),h},$UI.MsgBox=function(n,t,i,r,u,f){$UI.MsgBoxEx(n,t,i,r,f,null,u,null,!1)}